# BlueShark System Architecture
**Version:** 1.0.0
**Last Updated:** 2025-11-29
**Authors:** Development Team

---

## Table of Contents
1. [Executive Summary](#1-executive-summary)
2. [System Overview](#2-system-overview)
3. [Environment Strategy](#3-environment-strategy)
4. [Database Architecture](#4-database-architecture)
5. [Deployment Pipeline](#5-deployment-pipeline)
6. [Multi-Client Scalability](#6-multi-client-scalability)
7. [Current Status & Issues](#7-current-status--issues)
8. [Action Items](#8-action-items)

---

## 1. Executive Summary

BlueShark is a **Production Management System** designed for textile/garment manufacturing operations. The system tracks:
- Rolls â†’ Batches â†’ Sub-Batches â†’ Department workflow
- Worker assignments and productivity
- Quality Control (alterations, rejections)
- Billing and reporting

**Architecture Goal:** Build a scalable SaaS platform that can serve multiple clients while maintaining strict data isolation and easy deployment.

---

## 2. System Overview

### 2.1 Technology Stack

| Layer      | Technology        | Purpose                          |
|------------|-------------------|----------------------------------|
| Frontend   | Next.js 15.5      | React-based web application      |
| Backend    | Express.js + Node | REST API server                  |
| ORM        | Prisma            | Database abstraction & migrations|
| Database   | PostgreSQL (Neon) | Serverless, branch-based DB      |
| Hosting    | Vercel + Render   | Frontend + Backend hosting       |
| Version Control | GitHub       | Code repository & CI/CD triggers |

### 2.2 High-Level Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           USERS                                      â”‚
â”‚                    (Admin / Supervisor)                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      FRONTEND (Vercel)                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  Next.js Application                                         â”‚    â”‚
â”‚  â”‚  - Admin Dashboard (/Dashboard)                              â”‚    â”‚
â”‚  â”‚  - Supervisor Dashboard (/SupervisorDashboard)               â”‚    â”‚
â”‚  â”‚  - Login Pages                                               â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                      â”‚
â”‚  Production: edge-flow-gamma.vercel.app                             â”‚
â”‚  (Auto-deploys from: main branch)                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚ HTTPS API Calls
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      BACKEND (Render)                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  Express.js API Server                                       â”‚    â”‚
â”‚  â”‚  - /api/auth/* (Authentication)                              â”‚    â”‚
â”‚  â”‚  - /api/rolls, /api/batches, /api/sub-batches               â”‚    â”‚
â”‚  â”‚  - /api/workers, /api/departments                            â”‚    â”‚
â”‚  â”‚  - /api/worker-logs, /api/department-sub-batches            â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                      â”‚
â”‚  Production: edge-flow-backend.onrender.com                         â”‚
â”‚  (Auto-deploys from: main branch)                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚ Prisma ORM
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      DATABASE (Neon PostgreSQL)                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚  production branch   â”‚    â”‚  development branch  â”‚               â”‚
â”‚  â”‚  (Client Data)       â”‚    â”‚  (Testing/Dev)       â”‚               â”‚
â”‚  â”‚  30.79 MB            â”‚    â”‚  Clean sandbox       â”‚               â”‚
â”‚  â”‚                      â”‚    â”‚                      â”‚               â”‚
â”‚  â”‚  ep-odd-sunset-*     â”‚    â”‚  ep-orange-rice-*    â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚                                                                      â”‚
â”‚  Region: Singapore (ap-southeast-1)                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 3. Environment Strategy

### 3.1 Two-Environment Model

| Environment | Purpose | Who Uses | Data |
|-------------|---------|----------|------|
| **Development** | Build features, fix bugs, experiment | Developers | Test/mock data only |
| **Production** | Live client operations | Client users | Real production data |

### 3.2 Environment Configuration

#### Development Environment
```
Frontend: localhost:3000
Backend:  localhost:4000
Database: Neon development branch (ep-orange-rice-*)
```

#### Production Environment
```
Frontend: edge-flow-gamma.vercel.app
Backend:  edge-flow-backend.onrender.com
Database: Neon production branch (ep-odd-sunset-*)
```

### 3.3 Golden Rules

1. **NEVER** connect local development to production database
2. **NEVER** push directly to main branch (always PR from dev branch)
3. **ALWAYS** test in development before merging to production
4. **ALWAYS** back up production data before major migrations

---

## 4. Database Architecture

### 4.1 Neon Branch Strategy

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     NEON PROJECT                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  production (DEFAULT)                                â”‚    â”‚
â”‚  â”‚  â””â”€â”€ Client's live data                             â”‚    â”‚
â”‚  â”‚      â””â”€â”€ All tables with real records               â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                          â”‚                                   â”‚
â”‚                          â”‚ (branched from)                   â”‚
â”‚                          â–¼                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  development                                         â”‚    â”‚
â”‚  â”‚  â””â”€â”€ Schema only (no client data)                   â”‚    â”‚
â”‚  â”‚      â””â”€â”€ Used for feature development               â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.2 Database Schema (Core Tables)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    Vendor    â”‚     â”‚     Roll     â”‚     â”‚      Batch       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id           â”‚â—„â”€â”€â”€â”€â”‚ vendor_id    â”‚â—„â”€â”€â”€â”€â”‚ roll_id          â”‚
â”‚ name         â”‚     â”‚ id           â”‚     â”‚ id               â”‚
â”‚ contact      â”‚     â”‚ name         â”‚     â”‚ name             â”‚
â”‚ address      â”‚     â”‚ type         â”‚     â”‚ quantity         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚ quantity     â”‚     â”‚ color            â”‚
                     â”‚ unit         â”‚     â”‚ unit             â”‚
                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚ date             â”‚
                                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                   â”‚
                                                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Department  â”‚     â”‚              SubBatch                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id           â”‚â—„â”€â”€â”€â”€â”‚ id                                   â”‚
â”‚ name         â”‚     â”‚ batch_id                             â”‚
â”‚ order        â”‚     â”‚ name                                 â”‚
â”‚ description  â”‚     â”‚ quantity                             â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚ current_department_id                â”‚
       â”‚             â”‚ status                               â”‚
       â”‚             â”‚ department_flow                      â”‚
       â”‚             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                              â”‚
       â–¼                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              DepartmentSubBatch (Junction)               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id                                                       â”‚
â”‚ sub_batch_id â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
â”‚ department_id â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚ quantity_received                                        â”‚
â”‚ quantity_sent                                            â”‚
â”‚ status (PENDING/IN_PROGRESS/COMPLETED/SENT)             â”‚
â”‚ is_current                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      WorkerLog                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id                                                       â”‚
â”‚ department_sub_batch_id                                  â”‚
â”‚ worker_id â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º â”‚
â”‚ quantity                                                 â”‚
â”‚ date                                                     â”‚
â”‚ activity_type (NORMAL/ALTERED/REJECTED)                 â”‚
â”‚ is_billable                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.3 Database Connection Strings

| Branch | Endpoint | Pooler URL |
|--------|----------|------------|
| production | ep-odd-sunset-a15pegww | `postgresql://neondb_owner:***@ep-odd-sunset-a15pegww-pooler.ap-southeast-1.aws.neon.tech/neondb` |
| development | ep-orange-rice-a1w8omkg | `postgresql://neondb_owner:***@ep-orange-rice-a1w8omkg-pooler.ap-southeast-1.aws.neon.tech/neondb` |

---

## 5. Deployment Pipeline

### 5.1 Git Branch Strategy

```
main (protected)
  â”‚
  â”‚â—„â”€â”€â”€ Merge via PR (requires review)
  â”‚
sadin/dev (development branch)
  â”‚
  â”‚â—„â”€â”€â”€ All development work happens here
  â”‚
feature/* (optional feature branches)
```

### 5.2 Deployment Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Developer  â”‚â”€â”€â”€â”€â–ºâ”‚  sadin/dev  â”‚â”€â”€â”€â”€â–ºâ”‚    PR to    â”‚â”€â”€â”€â”€â–ºâ”‚    main     â”‚
â”‚  commits    â”‚     â”‚  branch     â”‚     â”‚    main     â”‚     â”‚   branch    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                                                                   â”‚
                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”
                          â”‚                                             â”‚
                          â–¼                                             â–¼
                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                   â”‚   Vercel    â”‚                              â”‚   Render    â”‚
                   â”‚  Frontend   â”‚                              â”‚   Backend   â”‚
                   â”‚  Auto-deployâ”‚                              â”‚  Auto-deployâ”‚
                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.3 Deployment Checklist

Before merging to main:
- [ ] All features tested in development
- [ ] No TypeScript/ESLint errors
- [ ] Database migrations tested
- [ ] API endpoints tested
- [ ] Environment variables verified
- [ ] Backup production data (if schema changes)

---

## 6. Multi-Client Scalability

### 6.1 Future Architecture (Multi-Tenant)

When onboarding new clients, we have two options:

#### Option A: Shared Database with Tenant ID
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Single Database                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  All tables have: tenant_id column                   â”‚    â”‚
â”‚  â”‚  - Client A data: tenant_id = 1                     â”‚    â”‚
â”‚  â”‚  - Client B data: tenant_id = 2                     â”‚    â”‚
â”‚  â”‚  - Client C data: tenant_id = 3                     â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```
**Pros:** Single deployment, easy maintenance
**Cons:** Data isolation requires careful coding, harder compliance

#### Option B: Separate Database per Client (Recommended)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Neon Project                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  client_a_db  â”‚  â”‚  client_b_db  â”‚  â”‚  client_c_db  â”‚    â”‚
â”‚  â”‚  (branch)     â”‚  â”‚  (branch)     â”‚  â”‚  (branch)     â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```
**Pros:** Complete data isolation, easy compliance, client-specific customization
**Cons:** More infrastructure to manage

### 6.2 Recommended Multi-Client Setup

```
For each new client:
1. Create new Neon branch: client_{name}_prod
2. Create new Render backend instance (or use dynamic DB routing)
3. Create new Vercel deployment (or use subdomain routing)
4. Configure client-specific environment variables

Example:
- Client A: clienta.blueshark.app â†’ clienta-backend â†’ client_a_db
- Client B: clientb.blueshark.app â†’ clientb-backend â†’ client_b_db
```

---

## 7. Current Status & Issues

### 7.1 What's Working âœ…

| Component | Status | URL |
|-----------|--------|-----|
| GitHub Repository | âœ… Live | github.com/Zunkiree-Technologies/edge-flow |
| Vercel Frontend | âœ… Deployed | edge-flow-gamma.vercel.app |
| Render Backend | âœ… Running | edge-flow-backend.onrender.com |
| Neon Database | âœ… Provisioned | ap-southeast-1 (Singapore) |

### 7.2 Current Issues ğŸ”´

| Issue | Severity | Description | Resolution |
|-------|----------|-------------|------------|
| Production DB Tables Missing | ğŸ”´ CRITICAL | Render backend cannot find tables | Run `prisma db push` on production |
| Login Not Working | ğŸ”´ CRITICAL | Users cannot authenticate | Depends on DB fix |
| Local .env Misconfigured | ğŸŸ¡ WARNING | Points to wrong endpoints | Update local .env files |

### 7.3 Environment Variable Status

#### Render Backend (.env on Render)
```
DATABASE_URL = ??? (Need to verify)
JWT_SECRET   = ??? (Need to verify)
```

#### Vercel Frontend (Environment Variables)
```
NEXT_PUBLIC_API_URL                  = https://edge-flow-backend.onrender.com âœ…
NEXT_PUBLIC_API_LOGIN_URL_ADMIN      = https://edge-flow-backend.onrender.com/auth/login âŒ
NEXT_PUBLIC_API_LOGIN_URL_SUPERVISOR = https://edge-flow-backend.onrender.com/auth/supervisor-login âŒ
```

**Note:** Login URLs should be `/api/auth/login` not `/auth/login`

---

## 8. Action Items

### Phase 1: Fix Production (CRITICAL)

| # | Task | Owner | Status |
|---|------|-------|--------|
| 1.1 | Verify Render DATABASE_URL points to production Neon branch | DevOps | â³ |
| 1.2 | Run `prisma db push` to create tables in production | DevOps | â³ |
| 1.3 | Create admin user in production database | DevOps | â³ |
| 1.4 | Fix Vercel login URL environment variables | DevOps | â³ |
| 1.5 | Test login on production | QA | â³ |

### Phase 2: Fix Development Environment

| # | Task | Owner | Status |
|---|------|-------|--------|
| 2.1 | Configure local backend .env for development DB | Dev | â³ |
| 2.2 | Configure local frontend .env for localhost | Dev | â³ |
| 2.3 | Seed development database with test data | Dev | â³ |
| 2.4 | Test local development workflow | Dev | â³ |

### Phase 3: Documentation

| # | Task | Owner | Status |
|---|------|-------|--------|
| 3.1 | Complete API documentation | Dev | â³ |
| 3.2 | Create database schema documentation | Dev | â³ |
| 3.3 | Write deployment runbook | DevOps | â³ |
| 3.4 | Create developer onboarding guide | Dev | â³ |

### Phase 4: Security & Performance (Future)

| # | Task | Owner | Status |
|---|------|-------|--------|
| 4.1 | Implement password hashing (bcrypt) | Dev | â³ |
| 4.2 | Add database indexes | Dev | â³ |
| 4.3 | Optimize N+1 queries | Dev | â³ |
| 4.4 | Set up monitoring/logging | DevOps | â³ |

---

## Appendix

### A. Useful Commands

```bash
# Local Development
cd blueshark-backend-test/backend
npm run dev

# Database Operations
npx prisma db push          # Push schema to database
npx prisma generate         # Generate Prisma client
npx prisma studio           # Open database GUI

# Git Workflow
git checkout sadin/dev      # Switch to dev branch
git pull origin sadin/dev   # Get latest changes
git push origin sadin/dev   # Push changes

# Deployment
# Vercel: Auto-deploys on push to main
# Render: Auto-deploys on push to main
```

### B. Contact & Resources

- **GitHub Repo:** github.com/Zunkiree-Technologies/edge-flow
- **Neon Console:** console.neon.tech
- **Vercel Dashboard:** vercel.com/dashboard
- **Render Dashboard:** dashboard.render.com

---

**Document Status:** Living document - update as architecture evolves
